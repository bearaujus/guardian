"use strict";(self.webpackChunkguardian=self.webpackChunkguardian||[]).push([[180],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return s}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),o=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=o(e.components);return n.createElement(d.Provider,{value:t},e.children)},k={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},N=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),N=o(a),s=r,f=N["".concat(d,".").concat(s)]||N[s]||k[s]||i;return a?n.createElement(f,l(l({ref:t},m),{},{components:a})):n.createElement(f,l({ref:t},m))}));function s(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=N;var p={};for(var d in t)hasOwnProperty.call(t,d)&&(p[d]=t[d]);p.originalType=e,p.mdxType="string"==typeof e?e:r,l[1]=p;for(var o=2;o<i;o++)l[o]=a[o];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}N.displayName="MDXCreateElement"},4646:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return k},frontMatter:function(){return i},metadata:function(){return p},toc:function(){return o}});var n=a(3117),r=(a(7294),a(3905));const i={},l="Policy",p={unversionedId:"reference/policy",id:"reference/policy",title:"Policy",description:"YAML Representation",source:"@site/docs/reference/policy.md",sourceDirName:"reference",slug:"/reference/policy",permalink:"/guardian/docs/reference/policy",draft:!1,editUrl:"https://github.com/odpf/guardian/edit/master/docs/docs/reference/policy.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Appeal",permalink:"/guardian/docs/reference/appeal"},next:{title:"Provider",permalink:"/guardian/docs/reference/provider"}},d={},o=[{value:"YAML Representation",id:"yaml-representation",level:4},{value:"<code>Policy</code>",id:"policy-1",level:3},{value:"<code>Step</code>",id:"step",level:3},{value:"<code>PolicyAppealConfig</code>",id:"policyappealconfig",level:3},{value:"<code>DurationOptions</code>",id:"durationoptions",level:3},{value:"<code>IAM</code>",id:"iam",level:3},{value:"<code>Requirement</code>",id:"requirement",level:3},{value:"<code>Expression</code>",id:"expression",level:3},{value:"Variables",id:"variables",level:4}],m={toc:o};function k(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"policy"},"Policy"),(0,r.kt)("h4",{id:"yaml-representation"},"YAML Representation"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"id: bigquery_approval\nversion: 1\nsteps:\n  - name: supervisor_approval\n    description: 'only will get evaluated if check_if_dataset_is_pii return true'\n    when: $appeal.resource.details.is_pii\n    strategy: manual\n    approvers:\n      - $appeal.creator.userManager\n  - name: admin_approval\n    description: approval from dataset admin/owner\n    strategy: manual\n    approvers:\n      - $appeal.resource.details.owner\nappeal_config:\n  duration_options:\n    - name: 1 Day\n      value: 24h\n    - name: 3 Days\n      value: 72h\n    - name: Permanent\n      value: 0h\niam:\n  provider: http\n  config:\n    url: http://localhost:5000/users/{user_id}\n  schema:\n    id: user_id\n    name: full_name\n    email: email\n    entity: company_name\n    userManager: manager_email\nrequirements:\n  - on:\n      provider_type: bigquery\n      role: writer\n    appeals:\n      - resource:\n          id: 99\n        role: roles/bigquery.jobUser\n        policy:\n          id: auto_approval\n          version: 1\n")),(0,r.kt)("h3",{id:"policy-1"},(0,r.kt)("inlineCode",{parentName:"h3"},"Policy")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"id")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Policy unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"version")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uint")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Auto increment value. Keeping the"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"steps")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#step"},(0,r.kt)("inlineCode",{parentName:"a"},"[]object(Step)"))),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sequence of approval steps"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeal_config")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"object(PolicyAppealConfig)")),(0,r.kt)("td",{parentName:"tr",align:"left"},"appeal configuration options"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"iam")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#iam"},(0,r.kt)("inlineCode",{parentName:"a"},"object(IAM)"))),(0,r.kt)("td",{parentName:"tr",align:"left"},"Identity manager configuration for client and identity/creator schema"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"requirements")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#requirement"},(0,r.kt)("inlineCode",{parentName:"a"},"[]object(Requirement)"))),(0,r.kt)("td",{parentName:"tr",align:"left"},"Additional appeals"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")))),(0,r.kt)("h3",{id:"step"},(0,r.kt)("inlineCode",{parentName:"h3"},"Step")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"name")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Approval step identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"description")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Approval step description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"when")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#expression"},(0,r.kt)("inlineCode",{parentName:"a"},"Expression"))),(0,r.kt)("td",{parentName:"tr",align:"left"},"Determines whether the step should be evaluated or it can be skipped. If it evaluates to be falsy, the step will automatically skipped. Otherwise, step become pending/blocked (normal)."),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"strategy")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Execution behaviour of the step. Possible values are ",(0,r.kt)("inlineCode",{parentName:"td"},"auto")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"manual")),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"rejection_reason")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"This fills ",(0,r.kt)("inlineCode",{parentName:"td"},"Approval.Reason")," if current approval step gets rejected based on ",(0,r.kt)("inlineCode",{parentName:"td"},"ApproveIf")," expression. If ",(0,r.kt)("inlineCode",{parentName:"td"},"strategy=manual"),", this field ignored."),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"approvers")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"[]string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"List of email or ",(0,r.kt)("a",{parentName:"td",href:"#expression"},(0,r.kt)("inlineCode",{parentName:"a"},"Expression"))," string. The ",(0,r.kt)("inlineCode",{parentName:"td"},"Expression")," is expected to return an email address or list of email addresses."),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES if ",(0,r.kt)("inlineCode",{parentName:"td"},"strategy")," is ",(0,r.kt)("inlineCode",{parentName:"td"},"manual"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"approve_if")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#expression"},(0,r.kt)("inlineCode",{parentName:"a"},"Expression"))),(0,r.kt)("td",{parentName:"tr",align:"left"},"Determines the automatic resolution of current step when ",(0,r.kt)("inlineCode",{parentName:"td"},"strategy")," is ",(0,r.kt)("inlineCode",{parentName:"td"},"auto")),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES if ",(0,r.kt)("inlineCode",{parentName:"td"},"strategy")," is ",(0,r.kt)("inlineCode",{parentName:"td"},"auto"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"allow_failed")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"boolean")),(0,r.kt)("td",{parentName:"tr",align:"left"},"If ",(0,r.kt)("inlineCode",{parentName:"td"},"true"),", and current step is rejected, it will mark the appeal status as skipped instead of rejected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")))),(0,r.kt)("h3",{id:"policyappealconfig"},(0,r.kt)("inlineCode",{parentName:"h3"},"PolicyAppealConfig")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"duration_options"),(0,r.kt)("td",{parentName:"tr",align:"left"},"[]object(DurationOptions)"),(0,r.kt)("td",{parentName:"tr",align:"left"},"list of duration options"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")))),(0,r.kt)("h3",{id:"durationoptions"},(0,r.kt)("inlineCode",{parentName:"h3"},"DurationOptions")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"name of duration"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"value"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"actual value of duration such as ",(0,r.kt)("inlineCode",{parentName:"td"},"24h"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"72h"),". value will be ",(0,r.kt)("inlineCode",{parentName:"td"},"0h")," in case of permanent duration. ",(0,r.kt)("br",null),' Valid time units are "ns", "us" (or "\xb5s"), "ms", "s", "m", "h". Reference: ',(0,r.kt)("a",{parentName:"td",href:"https://pkg.go.dev/time#ParseDuration"},"ParseDuration")),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")))),(0,r.kt)("h3",{id:"iam"},(0,r.kt)("inlineCode",{parentName:"h3"},"IAM")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"provider")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Identity manager type. Supported types are ",(0,r.kt)("inlineCode",{parentName:"td"},"http")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"shield")),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"config")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"object")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Client configuration according to the ",(0,r.kt)("inlineCode",{parentName:"td"},"provider")," type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"schema")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"map<string,string>")),(0,r.kt)("td",{parentName:"tr",align:"left"},"User (appeal creator) profile details schema to be shown in the ",(0,r.kt)("inlineCode",{parentName:"td"},"creator")," field in an appeal"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")))),(0,r.kt)("h3",{id:"requirement"},(0,r.kt)("inlineCode",{parentName:"h3"},"Requirement")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"on")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"object")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Criteria or conditions based on the current appeal to check before creating additional appeals"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"on.provider_type")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Criteria for the provider type of the current appeal's selected resource. Regex supported"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"on.provider_urn")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Criteria for the provider URN of the current appeal's selected resource. Regex supported"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"on.resource_type")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Criteria for the resource type of the current appeal's selected resource. Regex supported"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"on.resource_urn")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Criteria for the resource type of the current appeal's selected resource. Regex supported"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"on.role")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Criteria for the role of the current appeal. Regex supported"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"[]object")),(0,r.kt)("td",{parentName:"tr",align:"left"},"List of additional appeals that will automatically created when ",(0,r.kt)("inlineCode",{parentName:"td"},"on")," criteria is fulfilled"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"object")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource selector"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.id")),(0,r.kt)("td",{parentName:"tr",align:"left"},"uint"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource selector using the resource unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.provider_type")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource selector using ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_type"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_urn"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"type"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"urn"),". Required if ",(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.id")," is not present"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.provider_urn")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource selector using ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_type"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_urn"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"type"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"urn"),". Required if ",(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.id")," is not present"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.type")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource selector using ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_type"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_urn"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"type"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"urn"),". Required if ",(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.id")," is not present"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.urn")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource selector using ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_type"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"provider_urn"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"type"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"urn"),". Required if ",(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].resource.id")," is not present"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].role")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Role/permission to be assigned to the ",(0,r.kt)("inlineCode",{parentName:"td"},"account_id")," of the current appeal to access the resource specified in the ",(0,r.kt)("inlineCode",{parentName:"td"},"resource")," selector field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].policy")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"object")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Policy selector to be used for overriding the original policy linked to the resource specified in the ",(0,r.kt)("inlineCode",{parentName:"td"},"resource")," selector field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NO")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].policy.id")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Policy identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].policy.version")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uint")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Policy version identifier. Used together with ",(0,r.kt)("inlineCode",{parentName:"td"},"appeals[].policy.id")," to reference to a policy"),(0,r.kt)("td",{parentName:"tr",align:"left"},"YES")))),(0,r.kt)("h3",{id:"expression"},(0,r.kt)("inlineCode",{parentName:"h3"},"Expression")),(0,r.kt)("p",null,"Expression is an evaluatable statement intented to make the policy highly flexible. Guardian\nuses ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/antonmedv/expr"},"https://github.com/antonmedv/expr")," to parse expressions. There's also some accessible variables specific to Guardian\nuse cases:"),(0,r.kt)("h4",{id:"variables"},"Variables"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$appeal"),": ",(0,r.kt)("a",{parentName:"p",href:"/guardian/docs/reference/appeal#appeal-1"},(0,r.kt)("inlineCode",{parentName:"a"},"Appeal"))),(0,r.kt)("p",{parentName:"li"},"Usage example:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$appeal.resource.id")," =",">"," ",(0,r.kt)("inlineCode",{parentName:"li"},"1")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$appeal.resource.details.owners")," =",">"," ",(0,r.kt)("inlineCode",{parentName:"li"},'["owner@email.com", "another.owner@email.com"]')),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$appeal.resource.labels.key")," =",">"," ",(0,r.kt)("inlineCode",{parentName:"li"},'"value"')),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$appeal.creator.manager_email")," =",">"," ",(0,r.kt)("inlineCode",{parentName:"li"},'"manager@email.com"'))))))}k.isMDXComponent=!0}}]);