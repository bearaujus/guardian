"use strict";(self.webpackChunkguardian=self.webpackChunkguardian||[]).push([[296],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?r.createElement(g,i(i({ref:t},u),{},{components:n})):r.createElement(g,i({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6047:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return i},default:function(){return p},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return c}});var r=n(3117),a=(n(7294),n(3905));const o={},i="GCS",s={unversionedId:"providers/gcs",id:"providers/gcs",title:"GCS",description:"Google Cloud Storage(in short GCS) is the object storage service offered by Google Cloud. GCS has distinct namespaces called Buckets that each one contains multiple Objects which are used for storing the data.",source:"@site/docs/providers/gcs.md",sourceDirName:"providers",slug:"/providers/gcs",permalink:"/guardian/docs/providers/gcs",draft:!1,editUrl:"https://github.com/odpf/guardian/edit/master/docs/docs/providers/gcs.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"GCP",permalink:"/guardian/docs/providers/gcloud_iam"},next:{title:"Grafana",permalink:"/guardian/docs/providers/grafana"}},l={},c=[{value:"GCS Resources",id:"gcs-resources",level:3},{value:"GCS Users",id:"gcs-users",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Authentication",id:"authentication",level:3},{value:"Access Management",id:"access-management",level:2},{value:"Provider Config",id:"provider-config",level:2},{value:"YAML Representation",id:"yaml-representation",level:4},{value:"GCS Account Types",id:"gcs-account-types",level:3},{value:"GCS Credentials",id:"gcs-credentials",level:3},{value:"GCS Resource Types",id:"gcs-resource-types",level:3},{value:"GCS Resource Permission",id:"gcs-resource-permission",level:3}],u={toc:c};function p(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"gcs"},"GCS"),(0,a.kt)("p",null,"Google Cloud Storage(in short GCS) is the object storage service offered by Google Cloud. GCS has distinct namespaces called ",(0,a.kt)("strong",{parentName:"p"},"Buckets")," that each one contains multiple ",(0,a.kt)("strong",{parentName:"p"},"Objects")," which are used for storing the data. "),(0,a.kt)("p",null,"It provides features such as object versioning or fine-grain permissions (per object or bucket). Using GCS one can retrieve and upload files using a REST API, and this can extend infinitely with each object scaling up to the terabyte size."),(0,a.kt)("h3",{id:"gcs-resources"},"GCS Resources"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Organization"),": The Organization resource represents an organization (for example, a\ncompany) and is the root node in the Google Cloud resource hierarchy. Your\ncompany, called Example Inc., creates a Google Cloud organization called\nexampleinc.org."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Project"),": A project organizes all your Google Cloud resources. All data in Cloud Storage\nbelongs inside a project. A project consists of a set of users; a set of APIs; and billing,\nauthentication, and monitoring settings for those APIs. Example Inc. is building several\napplications, and each one is associated with a project."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Bucket"),": Each project can contain multiple buckets, which are containers to store your\nobjects.You can use buckets to organize your data and control access to your data, but\nunlike directories and folders, you cannot nest buckets. For example, you might create a\nphotos bucket for all the image files your app generates and a separate video bucket."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Object"),": Objects are the individual pieces of data that you store in Cloud Storage.There is\nno limit on the number of objects that you can create in a bucket. An individual file, such as an image called odpf.png.")),(0,a.kt)("h3",{id:"gcs-users"},"GCS Users"),(0,a.kt)("p",null,"GCS allows Google Account, Service account, Google group, Google Workspace account, Cloud\nIdentity domain, All authenticated users, All users allowed to access the buckets and objects\ninside a specific bucket. "),(0,a.kt)("p",null,"Currently, Guardian supports ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"user")),", ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"service account")),", ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"group"))," and ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"domain"))," as\nallowed account types."),(0,a.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"If a user/administrator wants to control access to a bucket or an object, the user must have\nsufficient permissions for the same. With these permissions, the resource owner can grant and\nrevoke other users/service accounts with selective access to these resources."),(0,a.kt)("p",null,"For registering Google Cloud Storage as a provider on Guardian, user must have a service\naccount with ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"roles/storage.admin"))," role at the project/organization level"),(0,a.kt)("h3",{id:"authentication"},"Authentication"),(0,a.kt)("p",null,"Guardian requires a ",(0,a.kt)("strong",{parentName:"p"},"service account key")," and the ",(0,a.kt)("strong",{parentName:"p"},"resource name")," of an administrator user in\nGoogle Cloud Storage. The Service Account key should be base64 encoded value."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"credentials:\nService_account_key: <base64 encoded Service Account Key>\nResource_name: projects/gcs-project-i\n")),(0,a.kt)("h2",{id:"access-management"},"Access Management"),(0,a.kt)("p",null,"Access can be given only at the bucket level on Guardian as those allowed to be managed through these Google Cloud Storage APIs:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://cloud.google.com/storage/docs/samples/storage-add-bucket-iam-member"},"Bucket Access Control"))),(0,a.kt)("h2",{id:"provider-config"},"Provider Config"),(0,a.kt)("h4",{id:"yaml-representation"},"YAML Representation"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"type: gcs\nurn: sample-URN\ncredentials:\n  service_account_key: <base64 encoded service account key json>\n  resource_name: projects/<gcs-project-id>\n  - type: bucket\n    policy:\n      id: my-first-policy\n      version: 1\n    roles:\n      - id: READER\n        name: Reader\n        description: 'Grants permission to list a bucket contents and read bucket metadata, excluding IAM policies'\n        permissions:\n          - roles/storage.legacyBucketReader\n      - id: WRITER\n        name: Writer\n        description: 'Grants permission to create, replace, and delete objects; list objects in a bucket'\n        permissions:\n          - roles/storage.legacyBucketWriter\n      - id: OWNER\n        name: Owner\n        description: 'Grants permission to update objects; list and update tag bindings; read object metadata when listing'\n        permissions:\n          - roles/storage.legacyBucketOwner\n      - id: ADMIN\n        name: Admin\n        description: 'Grants full control of buckets and objects'\n        permissions:\n          - roles/storage.admin\n      - id: OBJECTADMIN\n        name: ObjectAdmin\n        description: 'Grants full control over objects, including listing, creating, viewing, and deleting objects'\n        permissions:\n          - roles/storage.objectAdmin\n")),(0,a.kt)("h3",{id:"gcs-account-types"},"GCS Account Types"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"user")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"serviceAccount")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"group")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"domain"))),(0,a.kt)("h3",{id:"gcs-credentials"},"GCS Credentials"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Fields"),(0,a.kt)("th",{parentName:"tr",align:"left"}),(0,a.kt)("th",{parentName:"tr",align:"left"}))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"resource_name"),(0,a.kt)("td",{parentName:"tr",align:"left"},"string"),(0,a.kt)("td",{parentName:"tr",align:"left"},"GCP Project ID in resource name format. Example: ",(0,a.kt)("inlineCode",{parentName:"td"},"projects/my-project-id"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"service_account_key"),(0,a.kt)("td",{parentName:"tr",align:"left"},"string"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Service account key JSON that has ",(0,a.kt)("a",{parentName:"td",href:"#prerequisites"},"prerequisites permissions"),".",(0,a.kt)("br",null)," On provider creation, the value should be an base64 encoded JSON key.")))),(0,a.kt)("h3",{id:"gcs-resource-types"},"GCS Resource Types"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Bucket")),(0,a.kt)("h3",{id:"gcs-resource-permission"},"GCS Resource Permission"),(0,a.kt)("p",null,"A Google Cloud predefined role name. ",(0,a.kt)("a",{parentName:"p",href:"https://cloud.google.com/storage/docs/access-control/iam-roles"},(0,a.kt)("inlineCode",{parentName:"a"},"Read More"))),(0,a.kt)("p",null,"For ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("inlineCode",{parentName:"strong"},"Bucket"))," resource type, the list of allowed permissions are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.admin")," "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.legacyBucketOwner")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.legacyBucketReader")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.legacyBucketWriter")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.legacyObjectOwner")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.legacyObjectReader")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.objectAdmin")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.objectCreator")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"roles/storage.objectViewer"))))}p.isMDXComponent=!0}}]);