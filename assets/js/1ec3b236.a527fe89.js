"use strict";(self.webpackChunkguardian=self.webpackChunkguardian||[]).push([[21],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=s(a),m=l,g=d["".concat(p,".").concat(m)]||d[m]||c[m]||r;return a?n.createElement(g,o(o({ref:t},u),{},{components:a})):n.createElement(g,o({ref:t},u))}));function m(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,o=new Array(r);o[0]=d;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var s=2;s<r;s++)o[s]=a[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6720:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return i},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return u},default:function(){return d}});var n=a(7462),l=a(3366),r=(a(7294),a(3905)),o=["components"],i={},p="CLI",s={unversionedId:"guides/cli",id:"guides/cli",isDocsHomePage:!1,title:"CLI",description:"Guardian is a command line tool used to interact with the main guardian service.",source:"@site/docs/guides/cli.md",sourceDirName:"guides",slug:"/guides/cli",permalink:"/guardian/docs/guides/cli",editUrl:"https://github.com/odpf/guardian/edit/master/docs/docs/guides/cli.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Overview",permalink:"/guardian/docs/guides/overview"},next:{title:"Managing Policies",permalink:"/guardian/docs/guides/managing-policies"}},u=[{value:"List of Commands",id:"list-of-commands",children:[]},{value:"Config command",id:"config-command",children:[]},{value:"Policies command",id:"policies-command",children:[]},{value:"Providers command",id:"providers-command",children:[]},{value:"Resources command",id:"resources-command",children:[]},{value:"Appeals command",id:"appeals-command",children:[]}],c={toc:u};function d(e){var t=e.components,a=(0,l.Z)(e,o);return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"cli"},"CLI"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Guardian")," is a command line tool used to interact with the main guardian service."),(0,r.kt)("h2",{id:"list-of-commands"},"List of Commands"),(0,r.kt)("p",null,"Guardian CLI supports many commands. To get a list of all the commands, follow these steps."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Available Commands:\n  appeals     manage appeals\n  config      manage guardian CLI configuration\n  help        Help about any command\n  migrate     Migrate database schema\n  policies    manage policies\n  providers   manage providers\n  resources   manage resources\n  serve       Run server\n")),(0,r.kt)("h2",{id:"config-command"},"Config command"),(0,r.kt)("p",null,"Config command in Guardain's CLI is used to configure the command line tool. Following are a few examples of doing the same."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"What is inside?"))),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian config\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Available Commands:\n  init        initialize CLI configuration\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"init command"))),(0,r.kt)("p",null,"This command is used to initialize the ",(0,r.kt)("inlineCode",{parentName:"p"},".guardian.yaml")," file as demonstrated below."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian config init\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"config created: .guardian.yaml\n")),(0,r.kt)("p",null,"Now, in the ",(0,r.kt)("inlineCode",{parentName:"p"},".guardian.yaml")," file we can set the configuartions as shown here."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"host: localhost:3000\n")),(0,r.kt)("h2",{id:"policies-command"},"Policies command"),(0,r.kt)("p",null,"Policies command allows us to list, create or update policies."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"What is inside?"))),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian policies\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Available Commands:\n  create      create policy\n  list        list policies\n  update      update policy\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"create command"))),(0,r.kt)("p",null,"The create command is used to create a new policy. For this we have to define our policy file, which would be passed as a flag to the ",(0,r.kt)("inlineCode",{parentName:"p"},"create")," command."),(0,r.kt)("p",null,"For instance, we can create a policy file ",(0,r.kt)("inlineCode",{parentName:"p"},"policy.yaml")," as shown below."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"id: policy_x\nsteps:\n  - name: manager_approval\n    strategy: manual\n    approvers:\n    - $appeal.resource.details.manager\n  - name: head_approval\n    strategy: manual\n    approvers:\n    - $appeal.resource.details.head\n")),(0,r.kt)("p",null,"Now, we can create a policy using the ",(0,r.kt)("inlineCode",{parentName:"p"},"create")," command as demonstrated here."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian policies create --file policy.yaml\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"policy created with id: policy_x\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"list command"))),(0,r.kt)("p",null,"To get a list of all the policies present in the Guardian' database, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"list")," command as explained here."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian policies list\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"  ID             VERSION  DESCRIPTION                             STEPS                 \n  policy_x       1        two step policy for tableau workbooks   manager_approval,head_approval\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"update command"))),(0,r.kt)("p",null,"To update an existing policy present in the Guardian' database, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"update")," command as explained here."),(0,r.kt)("p",null,"For this first we update our ",(0,r.kt)("inlineCode",{parentName:"p"},"policy.yaml")," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"id: policy_x\nsteps:\n  - name: supervisor_approval\n    strategy: manual\n    approvers:\n    - $appeal.resource.details.supervisor\n  - name: head_approval\n    strategy: manual\n    approvers:\n    - $appeal.resource.details.head\n")),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian policies update --file policy.yaml\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"policy updated\n")),(0,r.kt)("p",null,"Note that on update of a policy it's version is also updated. We can verify this by listing all the policies."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"  ID             VERSION  DESCRIPTION                                       STEPS                 \n  policy_01      2        two step policy for tableau workbooks             supervisor_approval,head_approval\n")),(0,r.kt)("h2",{id:"providers-command"},"Providers command"),(0,r.kt)("p",null,"Providers command allows us to list, create or update providers."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"What is inside?"))),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian providers\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Available Commands:\n  create      register provider configuration\n  list        list providers\n  update      update provider configuration\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"create command"))),(0,r.kt)("p",null,"The create command is used to create a new provider. For this we have to define our provider's config file, which would be passed as a flag to the ",(0,r.kt)("inlineCode",{parentName:"p"},"create")," command."),(0,r.kt)("p",null,"For instance, we can create a config file ",(0,r.kt)("inlineCode",{parentName:"p"},"provider.yaml")," for tableau provider as shown below."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"type: tableau\nurn: 691acb66-27ef-4b4f-9222-f07052e6ffg0\nlabels:\n  entity: gojek\n  landscape: id\ncredentials:\n  host: https://prod-apnortheast-a.online.tableau.com\n  username: user@test.com\n  password: password@123\n  content_url: guardiantestsite\nappeal:\n  allow_active_access_extension_in: 7d\nresources:\n  - type: metric\n    policy:\n      id: policy_20\n      version: 1\n    roles:\n      - id: read\n        name: Read\n        permissions:\n          - name: Read:Allow\n      - id: write\n        name: Write\n        permissions:\n          - name: Write:Allow\n")),(0,r.kt)("p",null,"Now, we can create a provider using the ",(0,r.kt)("inlineCode",{parentName:"p"},"create")," command as demonstrated here."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian providers create --file provider.yaml\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"provider created with id: 26\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"list command"))),(0,r.kt)("p",null,"To get a list of all the providers present in the Guardian' database, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"list")," command as explained here."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian providers list\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"  ID  TYPE     URN                                   \n  21  tableau  691acb66-27ef-4b4f-9222-f07052e6ffc2  \n  22  tableau  691acb66-27ef-4b4f-9222-f07052e6ffc8  \n  26  tableau  691acb66-27ef-4b4f-9222-f07052e6ffg0  \n  24  tableau  691acb66-27ef-4b4f-9222-f07052e6ffd0\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"update command"))),(0,r.kt)("p",null,"To update an existing provider present in the Guardian' database, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"update")," command as explained here."),(0,r.kt)("p",null,"For this first we update our ",(0,r.kt)("inlineCode",{parentName:"p"},"provider.yaml")," file."),(0,r.kt)("p",null,"After that, we can execute the update command as explained here."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian providers update --file provider.yaml --id 26\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"provider updated\n")),(0,r.kt)("h2",{id:"resources-command"},"Resources command"),(0,r.kt)("p",null,"Resources command allows us to list and set metadata of resources."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"What is inside?"))),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian resources\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Available Commands:\n  list        list resources\n  metadata    manage resource's metadata\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"list command"))),(0,r.kt)("p",null,"It fetches the list of all the resources in the Guardian's database."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian resources list\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"ID    PROVIDER                              TYPE        URN                                   NAME                   \n3552  tableau                               view        8a48df6d-bb5c-438f-a038-35149011e1b5  Flight Delays          \n      691acb66-27ef-4b4f-9222-f07052e6ffc2                                                                           \n4704  tableau                               metric      a408051f-c394-4a73-8f33-7bf7ba001d99  my-test-metric-ishan   \n      691acb66-27ef-4b4f-9222-f07052e6ffc2                                                                           \n3792  tableau                               workbook    7c940f8b-34c7-44af-9998-b95deef54edd  Regional               \n      691acb66-27ef-4b4f-9222-f07052e6ffc8                                                                           \n3802  tableau                               view        3bd3acd1-0681-458b-9566-0519ba844519  Overview               \n      691acb66-27ef-4b4f-9222-f07052e6ffc8                                                                           \n3807  tableau                               view        703c58f2-5b7f-46ba-bf96-9f4b473e4da8  Commission Model       \n      691acb66-27ef-4b4f-9222-f07052e6ffc8                                                                           \n5614  tableau                               view        7342fec1-4092-4bd4-abf4-8e531fe0f8ad  Stocks                 \n      691acb66-27ef-4b4f-9222-f07052e6ffd0\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"metadata command"))),(0,r.kt)("h2",{id:"appeals-command"},"Appeals command"),(0,r.kt)("p",null,"Appeals command allows us to list, create, list and reject appeal."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"What is inside?"))),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian appeals\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Available Commands:\n  approve     approve an approval step\n  create      create appeal\n  list        list appeals\n  reject      reject an approval step\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"create command"))),(0,r.kt)("p",null,"It helps us to create a new appeal."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'$ guardian appeals create --resource-id 5624 --role write --user test-user@email.com --options.duration "24h"\n')),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"appeal created with id: 13\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"list command"))),(0,r.kt)("p",null,"It helps us to get the list of all the appeals in the Guardian's database."),(0,r.kt)("p",null,"Enter the following code into the terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"$ guardian appeals list\n")),(0,r.kt)("p",null,"The output is the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"  ID  USER                  RESOURCE ID  ROLE   STATUS\n  13  test-user@email.com   5624         write  pending\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"approve command"))),(0,r.kt)("p",null,"It's used to approve an appeal."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"reject command"))),(0,r.kt)("p",null,"It's used to reject an appeal."))}d.isMDXComponent=!0}}]);